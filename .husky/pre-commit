#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Install deps, lint, type check, test
pnpm install && \
pnpm eslint . --max-warnings 0 && \
pnpm tsc --noEmit --strict && \
pnpm test

# Self-test: Run gitingest on its own repo
REPO_URL=$(gh repo view --json url -q .url)
echo "Running self-test on $REPO_URL..."
./dist/index.js "$REPO_URL" --pipe || exit 1
